<!DOCTYPE html>
<html>
  <head>
    <title>SwiftSki's IDE</title>
    <link rel="stylesheet" href="./tomorrow-night.css">
    <script src="./highlight.pack.js"></script>
  </head>
  <div width="50%" height="5%" style="position:absolute; top:0px; left:0px;">
    <button onclick="fSwitch('js')">Javascript</button>
    <button onclick="fSwitch('html')">HTML</button>
  </div>
  <div width="50%" height="5%" style="position:absolute; top:0px; left:50%;">
    <button onclick="run()">run</button>
  </div>

  <div style="position:absolute; top:5%">
    <!--<textarea rows="38" cols="80" class="code js" id="js" autofocus>//code here!</textarea>
    <textarea rows="38" cols="80" class="code html" id="html" placeholder="leave blank for JS only" hidden></textarea>-->
    <pre height="100%" width="50%"><code id="js" class="js" contenteditable="true">//code here!</code></pre>
    <pre height="100%" width="50%"><code id="html" class="html" contenteditable="true"></code></pre hidden>
    <textarea rows="38" cols="80" id="console" disabled></textarea>
  </div>
  <script>
    "use strict";
    hljs.initHighlightingOnLoad();
    var page;

    function run() {
      page = '';
      page = window.open('', 'MsgWindow', 'height=1000, width=1000');
      page.console = {
        log(text) {
          document.getElementById('console').value += text + '\n';
        },
        clear() {
          document.getElementById('console').value = '';
        },
        error(text) {
          document.getElementById('console').value += 'ERROR: ' + text;
        }
      }
      let main = page.document.createElement('main');
      main.innerHTML = document.getElementById('html').value;
      page.document.body.appendChild(main);

      page.console.clear();
      page.eval(document.getElementById('js').value);
      if (document.getElementById('html').value == '') page.close();
    }

    function fSwitch(dest) {
      let elements = document.getElementsByClassName('code');
      for (let i = 0; i < elements.length; i++) {
        elements[i].hidden = true;
      }
      document.getElementById(dest).hidden = false;
    }

  </script>

</html>
